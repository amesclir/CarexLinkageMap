---
title: "CarexLinkageMap"
author: "amesclir"
date: "05/05/2015"
output: html_document
---

First, we load the package onemap and import the data set

```{r}

library (onemap)

f2.onemap <- read.mapmaker(file = "onemap.f2.txt")

```

Second, we assign markers to linkage groups

```{r}
twopts <- rf.2pts(f2.onemap, LOD=3, max.rf=0.5)
mark.all <- make_seq(twopts, "all")
LGs.f2.6.0.5 <- group(mark.all, LOD = 6, max.rf = 0.5)
LGs.f2.6.0.5 
```

Third, we get the genetic mapping of linkage groups

```{r}
set.map.fun(type="kosambi")

LG.f2.6.0.5.1 <- make_seq(LGs.f2.6.0.5, 1)
LG.f2.6.0.5.2 <- make_seq(LGs.f2.6.0.5, 2)
LG.f2.6.0.5.3 <- make_seq(LGs.f2.6.0.5, 3)
LG.f2.6.0.5.4 <- make_seq(LGs.f2.6.0.5, 4)
LG.f2.6.0.5.5 <- make_seq(LGs.f2.6.0.5, 5)
LG.f2.6.0.5.6 <- make_seq(LGs.f2.6.0.5, 6)
LG.f2.6.0.5.7 <- make_seq(LGs.f2.6.0.5, 7)
LG.f2.6.0.5.8 <- make_seq(LGs.f2.6.0.5, 8)
LG.f2.6.0.5.9 <- make_seq(LGs.f2.6.0.5, 9)
LG.f2.6.0.5.10 <- make_seq(LGs.f2.6.0.5, 10)
LG.f2.6.0.5.11 <- make_seq(LGs.f2.6.0.5, 11)
LG.f2.6.0.5.12 <- make_seq(LGs.f2.6.0.5, 12)
LG.f2.6.0.5.13 <- make_seq(LGs.f2.6.0.5, 13)
LG.f2.6.0.5.14 <- make_seq(LGs.f2.6.0.5, 14)
LG.f2.6.0.5.15 <- make_seq(LGs.f2.6.0.5, 15)
LG.f2.6.0.5.16 <- make_seq(LGs.f2.6.0.5, 16)
LG.f2.6.0.5.17 <- make_seq(LGs.f2.6.0.5, 17)
LG.f2.6.0.5.18 <- make_seq(LGs.f2.6.0.5, 18)
LG.f2.6.0.5.19 <- make_seq(LGs.f2.6.0.5, 19)
LG.f2.6.0.5.20 <- make_seq(LGs.f2.6.0.5, 20)
LG.f2.6.0.5.21 <- make_seq(LGs.f2.6.0.5, 21)
LG.f2.6.0.5.22 <- make_seq(LGs.f2.6.0.5, 22)
LG.f2.6.0.5.23 <- make_seq(LGs.f2.6.0.5, 23)
LG.f2.6.0.5.24 <- make_seq(LGs.f2.6.0.5, 24)
LG.f2.6.0.5.25 <- make_seq(LGs.f2.6.0.5, 25)
LG.f2.6.0.5.26 <- make_seq(LGs.f2.6.0.5, 26)
LG.f2.6.0.5.27 <- make_seq(LGs.f2.6.0.5, 27)
LG.f2.6.0.5.28 <- make_seq(LGs.f2.6.0.5, 28)
LG.f2.6.0.5.29 <- make_seq(LGs.f2.6.0.5, 29)
LG.f2.6.0.5.30 <- make_seq(LGs.f2.6.0.5, 30)
LG.f2.6.0.5.31 <- make_seq(LGs.f2.6.0.5, 31)
LG.f2.6.0.5.32 <- make_seq(LGs.f2.6.0.5, 32)




LG.f2.6.0.5.1.ord <- order_seq(LG.f2.6.0.5.1, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.2.ord <- order_seq(LG.f2.6.0.5.2, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.3.ord <- order_seq(LG.f2.6.0.5.3, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.4.ord <- order_seq(LG.f2.6.0.5.4, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.5.ord <- order_seq(LG.f2.6.0.5.5, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.6.ord <- order_seq(LG.f2.6.0.5.6, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.7.ord <- order_seq(LG.f2.6.0.5.7, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.8.ord <- order_seq(LG.f2.6.0.5.8, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.9.ord <- order_seq(LG.f2.6.0.5.9, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.10.ord <- order_seq(LG.f2.6.0.5.10, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.11.ord <- order_seq(LG.f2.6.0.5.11, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.12.ord <- order_seq(LG.f2.6.0.5.12, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.13.ord <- order_seq(LG.f2.6.0.5.13, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.14.ord <- order_seq(LG.f2.6.0.5.14, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.15.ord <- order_seq(LG.f2.6.0.5.15, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.16.ord <- order_seq(LG.f2.6.0.5.16, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.17.ord <- order_seq(LG.f2.6.0.5.17, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.18.ord <- order_seq(LG.f2.6.0.5.18, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.19.ord <- order_seq(LG.f2.6.0.5.19, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.20.ord <- order_seq(LG.f2.6.0.5.20, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.21.ord <- order_seq(LG.f2.6.0.5.21, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.22.ord <- order_seq(LG.f2.6.0.5.22, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.23.ord <- order_seq(LG.f2.6.0.5.23, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.24.ord <- order_seq(LG.f2.6.0.5.24, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.25.ord <- order_seq(LG.f2.6.0.5.25, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.26.ord <- order_seq(LG.f2.6.0.5.26, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.27.ord <- order_seq(LG.f2.6.0.5.27, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.28.ord <- order_seq(LG.f2.6.0.5.28, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.29.ord <- order_seq(LG.f2.6.0.5.29, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.30.ord <- order_seq(LG.f2.6.0.5.30, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.31.ord <- order_seq(LG.f2.6.0.5.31, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.32.ord <- order_seq(LG.f2.6.0.5.32, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)


```

Now, we order the markers, all of them and only the safe ones

```{r}
LG.f2.6.0.5.1.ord.safe <- make_seq(LG.f2.6.0.5.1.ord,"safe")
LG.f2.6.0.5.2.ord.safe <- make_seq(LG.f2.6.0.5.2.ord,"safe")
LG.f2.6.0.5.3.ord.safe <- make_seq(LG.f2.6.0.5.3.ord,"safe")
LG.f2.6.0.5.4.ord.safe <- make_seq(LG.f2.6.0.5.4.ord,"safe")
LG.f2.6.0.5.5.ord.safe <- make_seq(LG.f2.6.0.5.5.ord,"safe")
LG.f2.6.0.5.6.ord.safe <- make_seq(LG.f2.6.0.5.6.ord,"safe")
LG.f2.6.0.5.7.ord.safe <- make_seq(LG.f2.6.0.5.7.ord,"safe")
LG.f2.6.0.5.8.ord.safe <- make_seq(LG.f2.6.0.5.8.ord,"safe")
LG.f2.6.0.5.9.ord.safe <- make_seq(LG.f2.6.0.5.9.ord,"safe")
LG.f2.6.0.5.10.ord.safe <- make_seq(LG.f2.6.0.5.10.ord,"safe")
LG.f2.6.0.5.11.ord.safe <- make_seq(LG.f2.6.0.5.11.ord,"safe")
LG.f2.6.0.5.12.ord.safe <- make_seq(LG.f2.6.0.5.12.ord,"safe")
LG.f2.6.0.5.13.ord.safe <- make_seq(LG.f2.6.0.5.13.ord,"safe")
LG.f2.6.0.5.14.ord.safe <- make_seq(LG.f2.6.0.5.14.ord,"safe")
LG.f2.6.0.5.15.ord.safe <- make_seq(LG.f2.6.0.5.15.ord,"safe")
LG.f2.6.0.5.16.ord.safe <- make_seq(LG.f2.6.0.5.16.ord,"safe")
LG.f2.6.0.5.17.ord.safe <- make_seq(LG.f2.6.0.5.17.ord,"safe")
LG.f2.6.0.5.18.ord.safe <- make_seq(LG.f2.6.0.5.18.ord,"safe")
LG.f2.6.0.5.19.ord.safe <- make_seq(LG.f2.6.0.5.19.ord,"safe")
LG.f2.6.0.5.20.ord.safe <- make_seq(LG.f2.6.0.5.20.ord,"safe")
LG.f2.6.0.5.21.ord.safe <- make_seq(LG.f2.6.0.5.21.ord,"safe")
LG.f2.6.0.5.22.ord.safe <- make_seq(LG.f2.6.0.5.22.ord,"safe")
LG.f2.6.0.5.23.ord.safe <- make_seq(LG.f2.6.0.5.23.ord,"safe")
LG.f2.6.0.5.24.ord.safe <- make_seq(LG.f2.6.0.5.24.ord,"safe")
LG.f2.6.0.5.25.ord.safe <- make_seq(LG.f2.6.0.5.25.ord,"safe")
LG.f2.6.0.5.26.ord.safe <- make_seq(LG.f2.6.0.5.26.ord,"safe")
LG.f2.6.0.5.27.ord.safe <- make_seq(LG.f2.6.0.5.27.ord,"safe")
LG.f2.6.0.5.28.ord.safe <- make_seq(LG.f2.6.0.5.28.ord,"safe")
LG.f2.6.0.5.29.ord.safe <- make_seq(LG.f2.6.0.5.29.ord,"safe")
LG.f2.6.0.5.30.ord.safe <- make_seq(LG.f2.6.0.5.30.ord,"safe")
LG.f2.6.0.5.31.ord.safe <- make_seq(LG.f2.6.0.5.31.ord,"safe")
LG.f2.6.0.5.32.ord.safe <- make_seq(LG.f2.6.0.5.32.ord,"safe")

LG.f2.6.0.5.1.ord.all <- make_seq(LG.f2.6.0.5.1.ord,"force")
LG.f2.6.0.5.2.ord.all <- make_seq(LG.f2.6.0.5.2.ord,"force")
LG.f2.6.0.5.3.ord.all <- make_seq(LG.f2.6.0.5.3.ord,"force")
LG.f2.6.0.5.4.ord.all <- make_seq(LG.f2.6.0.5.4.ord,"force")
LG.f2.6.0.5.5.ord.all <- make_seq(LG.f2.6.0.5.5.ord,"force")
LG.f2.6.0.5.6.ord.all <- make_seq(LG.f2.6.0.5.6.ord,"force")
LG.f2.6.0.5.7.ord.all <- make_seq(LG.f2.6.0.5.7.ord,"force")
LG.f2.6.0.5.8.ord.all <- make_seq(LG.f2.6.0.5.8.ord,"force")
LG.f2.6.0.5.9.ord.all <- make_seq(LG.f2.6.0.5.9.ord,"force")
LG.f2.6.0.5.10.ord.all <- make_seq(LG.f2.6.0.5.10.ord,"force")
LG.f2.6.0.5.11.ord.all <- make_seq(LG.f2.6.0.5.11.ord,"force")
LG.f2.6.0.5.12.ord.all <- make_seq(LG.f2.6.0.5.12.ord,"force")
LG.f2.6.0.5.13.ord.all <- make_seq(LG.f2.6.0.5.13.ord,"force")
LG.f2.6.0.5.14.ord.all <- make_seq(LG.f2.6.0.5.14.ord,"force")
LG.f2.6.0.5.15.ord.all <- make_seq(LG.f2.6.0.5.15.ord,"force")
LG.f2.6.0.5.16.ord.all <- make_seq(LG.f2.6.0.5.16.ord,"force")
LG.f2.6.0.5.17.ord.all <- make_seq(LG.f2.6.0.5.17.ord,"force")
LG.f2.6.0.5.18.ord.all <- make_seq(LG.f2.6.0.5.18.ord,"force")
LG.f2.6.0.5.19.ord.all <- make_seq(LG.f2.6.0.5.19.ord,"force")
LG.f2.6.0.5.20.ord.all <- make_seq(LG.f2.6.0.5.20.ord,"force")
LG.f2.6.0.5.21.ord.all <- make_seq(LG.f2.6.0.5.21.ord,"force")
LG.f2.6.0.5.22.ord.all <- make_seq(LG.f2.6.0.5.22.ord,"force")
LG.f2.6.0.5.23.ord.all <- make_seq(LG.f2.6.0.5.23.ord,"force")
LG.f2.6.0.5.24.ord.all <- make_seq(LG.f2.6.0.5.24.ord,"force")
LG.f2.6.0.5.25.ord.all <- make_seq(LG.f2.6.0.5.25.ord,"force")
LG.f2.6.0.5.26.ord.all <- make_seq(LG.f2.6.0.5.26.ord,"force")
LG.f2.6.0.5.27.ord.all <- make_seq(LG.f2.6.0.5.27.ord,"force")
LG.f2.6.0.5.28.ord.all <- make_seq(LG.f2.6.0.5.28.ord,"force")
LG.f2.6.0.5.29.ord.all <- make_seq(LG.f2.6.0.5.29.ord,"force")
LG.f2.6.0.5.30.ord.all <- make_seq(LG.f2.6.0.5.30.ord,"force")
LG.f2.6.0.5.31.ord.all <- make_seq(LG.f2.6.0.5.31.ord,"force")
LG.f2.6.0.5.32.ord.all <- make_seq(LG.f2.6.0.5.32.ord,"force")

```

Drawing the genetic map

```{r}
Map.6.0.5.ord.safe <- list(
LG.f2.6.0.5.1.ord.safe, 
LG.f2.6.0.5.2.ord.safe, 
LG.f2.6.0.5.3.ord.safe, 
LG.f2.6.0.5.4.ord.safe, 
LG.f2.6.0.5.5.ord.safe, 
LG.f2.6.0.5.6.ord.safe, 
LG.f2.6.0.5.7.ord.safe, 
LG.f2.6.0.5.8.ord.safe, 
LG.f2.6.0.5.9.ord.safe, 
LG.f2.6.0.5.10.ord.safe,
LG.f2.6.0.5.11.ord.safe,
LG.f2.6.0.5.12.ord.safe,
LG.f2.6.0.5.13.ord.safe,
LG.f2.6.0.5.14.ord.safe,
LG.f2.6.0.5.15.ord.safe,
LG.f2.6.0.5.16.ord.safe,
LG.f2.6.0.5.17.ord.safe,
LG.f2.6.0.5.18.ord.safe,
LG.f2.6.0.5.19.ord.safe,
LG.f2.6.0.5.20.ord.safe,
LG.f2.6.0.5.21.ord.safe,
LG.f2.6.0.5.22.ord.safe,
LG.f2.6.0.5.23.ord.safe,
LG.f2.6.0.5.24.ord.safe,
LG.f2.6.0.5.25.ord.safe,
LG.f2.6.0.5.26.ord.safe,
LG.f2.6.0.5.27.ord.safe,
LG.f2.6.0.5.28.ord.safe,
LG.f2.6.0.5.29.ord.safe,
LG.f2.6.0.5.30.ord.safe,
LG.f2.6.0.5.31.ord.safe,
LG.f2.6.0.5.32.ord.safe)

Map.6.0.5.ord.all <- list(
LG.f2.6.0.5.1.ord.all, 
LG.f2.6.0.5.2.ord.all, 
LG.f2.6.0.5.3.ord.all, 
LG.f2.6.0.5.4.ord.all, 
LG.f2.6.0.5.5.ord.all, 
LG.f2.6.0.5.6.ord.all, 
LG.f2.6.0.5.7.ord.all, 
LG.f2.6.0.5.8.ord.all, 
LG.f2.6.0.5.9.ord.all, 
LG.f2.6.0.5.10.ord.all,
LG.f2.6.0.5.11.ord.all,
LG.f2.6.0.5.12.ord.all,
LG.f2.6.0.5.13.ord.all,
LG.f2.6.0.5.14.ord.all,
LG.f2.6.0.5.15.ord.all,
LG.f2.6.0.5.16.ord.all,
LG.f2.6.0.5.17.ord.all,
LG.f2.6.0.5.18.ord.all,
LG.f2.6.0.5.19.ord.all,
LG.f2.6.0.5.20.ord.all,
LG.f2.6.0.5.21.ord.all,
LG.f2.6.0.5.22.ord.all,
LG.f2.6.0.5.23.ord.all,
LG.f2.6.0.5.24.ord.all,
LG.f2.6.0.5.25.ord.all,
LG.f2.6.0.5.26.ord.all,
LG.f2.6.0.5.27.ord.all,
LG.f2.6.0.5.28.ord.all,
LG.f2.6.0.5.29.ord.all,
LG.f2.6.0.5.30.ord.all,
LG.f2.6.0.5.31.ord.all,
LG.f2.6.0.5.32.ord.all)

draw.map(Map.6.0.5.ord.safe, names= TRUE, grid=TRUE, cex.mrk=0.3)

draw.map(Map.6.0.5.ord.all, names= TRUE, grid=TRUE, cex.mrk=0.3)

```

Linage group 2 has more of 50 cM between the majority of the markers and the remaining 3

```{r}

LG.f2.6.0.5.2.ord.safe2 <- LG.f2.6.0.5.2.ord.safe
LG.f2.6.0.5.2.ord.safe2$seq.rf <- LG.f2.6.0.5.2.ord.safe$seq.rf[-c(1:3)]
LG.f2.6.0.5.2.ord.safe2$seq.phases <- LG.f2.6.0.5.2.ord.safe$seq.phases[-c(1:3)]
LG.f2.6.0.5.2.ord.safe2$seq.num <- LG.f2.6.0.5.2.ord.safe$seq.num[-c(1:3)]
LG.f2.6.0.5.2.ord.safe2

Map.6.0.5.ord.safe2 <- list(
LG.f2.6.0.5.1.ord.safe, 
LG.f2.6.0.5.2.ord.safe2, 
LG.f2.6.0.5.3.ord.safe, 
LG.f2.6.0.5.4.ord.safe, 
LG.f2.6.0.5.5.ord.safe, 
LG.f2.6.0.5.6.ord.safe, 
LG.f2.6.0.5.7.ord.safe, 
LG.f2.6.0.5.8.ord.safe, 
LG.f2.6.0.5.9.ord.safe, 
LG.f2.6.0.5.10.ord.safe,
LG.f2.6.0.5.11.ord.safe,
LG.f2.6.0.5.12.ord.safe,
LG.f2.6.0.5.13.ord.safe,
LG.f2.6.0.5.14.ord.safe,
LG.f2.6.0.5.15.ord.safe,
LG.f2.6.0.5.16.ord.safe,
LG.f2.6.0.5.17.ord.safe,
LG.f2.6.0.5.18.ord.safe,
LG.f2.6.0.5.19.ord.safe,
LG.f2.6.0.5.20.ord.safe,
LG.f2.6.0.5.21.ord.safe,
LG.f2.6.0.5.22.ord.safe,
LG.f2.6.0.5.23.ord.safe,
LG.f2.6.0.5.24.ord.safe,
LG.f2.6.0.5.25.ord.safe,
LG.f2.6.0.5.26.ord.safe,
LG.f2.6.0.5.27.ord.safe,
LG.f2.6.0.5.28.ord.safe,
LG.f2.6.0.5.29.ord.safe,
LG.f2.6.0.5.30.ord.safe,
LG.f2.6.0.5.31.ord.safe,
LG.f2.6.0.5.32.ord.safe)

draw.map(Map.6.0.5.ord.safe2, names= TRUE, grid=TRUE, cex.mrk=0.3)

```

Linage group 24 has more of 50 cM between the majority of the markers and the remaining 8

```{r}

LG.f2.6.0.5.24.ord.safe2 <- LG.f2.6.0.5.24.ord.safe
LG.f2.6.0.5.24.ord.safe2$seq.rf <- LG.f2.6.0.5.24.ord.safe$seq.rf[-c(1:8)]
LG.f2.6.0.5.24.ord.safe2$seq.phases <- LG.f2.6.0.5.24.ord.safe$seq.phases[-c(1:8)]
LG.f2.6.0.5.24.ord.safe2$seq.num <- LG.f2.6.0.5.24.ord.safe$seq.num[-c(1:8)]
LG.f2.6.0.5.24.ord.safe2

Map.6.0.5.ord.safe3 <- list(
LG.f2.6.0.5.1.ord.safe, 
LG.f2.6.0.5.2.ord.safe2, 
LG.f2.6.0.5.3.ord.safe, 
LG.f2.6.0.5.4.ord.safe, 
LG.f2.6.0.5.5.ord.safe, 
LG.f2.6.0.5.6.ord.safe, 
LG.f2.6.0.5.7.ord.safe, 
LG.f2.6.0.5.8.ord.safe, 
LG.f2.6.0.5.9.ord.safe, 
LG.f2.6.0.5.10.ord.safe,
LG.f2.6.0.5.11.ord.safe,
LG.f2.6.0.5.12.ord.safe,
LG.f2.6.0.5.13.ord.safe,
LG.f2.6.0.5.14.ord.safe,
LG.f2.6.0.5.15.ord.safe,
LG.f2.6.0.5.16.ord.safe,
LG.f2.6.0.5.17.ord.safe,
LG.f2.6.0.5.18.ord.safe,
LG.f2.6.0.5.19.ord.safe,
LG.f2.6.0.5.20.ord.safe,
LG.f2.6.0.5.21.ord.safe,
LG.f2.6.0.5.22.ord.safe,
LG.f2.6.0.5.23.ord.safe,
LG.f2.6.0.5.24.ord.safe2,
LG.f2.6.0.5.25.ord.safe,
LG.f2.6.0.5.26.ord.safe,
LG.f2.6.0.5.27.ord.safe,
LG.f2.6.0.5.28.ord.safe,
LG.f2.6.0.5.29.ord.safe,
LG.f2.6.0.5.30.ord.safe,
LG.f2.6.0.5.31.ord.safe,
LG.f2.6.0.5.32.ord.safe)

draw.map(Map.6.0.5.ord.safe3, names= TRUE, grid=TRUE, cex.mrk=0.3)

```

Finally, the linkage group 25 have over 40 cM between the majority of the markers and the last one


```{r}

LG.f2.6.0.5.25.ord.safe2 <- LG.f2.6.0.5.25.ord.safe
LG.f2.6.0.5.25.ord.safe2$seq.num <- LG.f2.6.0.5.25.ord.safe$seq.num[1:19]
LG.f2.6.0.5.25.ord.safe2$seq.rf <- LG.f2.6.0.5.25.ord.safe$seq.rf[1:18]
LG.f2.6.0.5.25.ord.safe2$seq.phases <- LG.f2.6.0.5.25.ord.safe$seq.phases[1:18]
LG.f2.6.0.5.25.ord.safe2

Map.6.0.5.ord.safe4 <- list(
LG.f2.6.0.5.1.ord.safe, 
LG.f2.6.0.5.2.ord.safe2, 
LG.f2.6.0.5.3.ord.safe, 
LG.f2.6.0.5.4.ord.safe, 
LG.f2.6.0.5.5.ord.safe, 
LG.f2.6.0.5.6.ord.safe, 
LG.f2.6.0.5.7.ord.safe, 
LG.f2.6.0.5.8.ord.safe, 
LG.f2.6.0.5.9.ord.safe, 
LG.f2.6.0.5.10.ord.safe,
LG.f2.6.0.5.11.ord.safe,
LG.f2.6.0.5.12.ord.safe,
LG.f2.6.0.5.13.ord.safe,
LG.f2.6.0.5.14.ord.safe,
LG.f2.6.0.5.15.ord.safe,
LG.f2.6.0.5.16.ord.safe,
LG.f2.6.0.5.17.ord.safe,
LG.f2.6.0.5.18.ord.safe,
LG.f2.6.0.5.19.ord.safe,
LG.f2.6.0.5.20.ord.safe,
LG.f2.6.0.5.21.ord.safe,
LG.f2.6.0.5.22.ord.safe,
LG.f2.6.0.5.23.ord.safe,
LG.f2.6.0.5.24.ord.safe2,
LG.f2.6.0.5.25.ord.safe2,
LG.f2.6.0.5.26.ord.safe,
LG.f2.6.0.5.27.ord.safe,
LG.f2.6.0.5.28.ord.safe,
LG.f2.6.0.5.29.ord.safe,
LG.f2.6.0.5.30.ord.safe,
LG.f2.6.0.5.31.ord.safe,
LG.f2.6.0.5.32.ord.safe)

draw.map(Map.6.0.5.ord.safe4, names= TRUE, grid=TRUE, cex.mrk=0.3)

```

This is our final map!

Now we are going to look for linkage groups with a higher number than markers under segregation distortion that what would be expected by chance.
But first we will check wether or not there is a correlation between missing data and segregation distortion.

```{r}

mydata <- read.csv(file="permutations1.csv")
mydata
x2 <- mydata[,2]
missingdata <- mydata[,3]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")


LG1 <- matrix(0, nrow=1000, ncol = 24)
for (j in 1:1000) LG1[j,] <- sample(x2, 24, replace = FALSE, prob = NULL)
histLG1 <- vector()
for (i in 1:1000) histLG1[i] <- length(LG1[i,][LG1[i,]>5.991])
hist(histLG1)
abline(v=1,col="red")

LG2 <- matrix(0, nrow=1000, ncol = 65)
for (j in 1:1000) LG2[j,] <- sample(x2, 65, replace = FALSE, prob = NULL)
histLG2 <- vector()
for (i in 1:1000) histLG2[i] <- length(LG2[i,][LG2[i,]>5.991])
hist(histLG2)
abline(v=19,col="red")

LG3 <- matrix(0, nrow=1000, ncol = 84)
for (j in 1:1000) LG3[j,] <- sample(x2, 84, replace = FALSE, prob = NULL)
histLG3 <- vector()
for (i in 1:1000) histLG3[i] <- length(LG3[i,][LG3[i,]>5.991])
hist(histLG3)
abline(v=20,col="red")

LG4 <- matrix(0, nrow=1000, ncol = 36)
for (j in 1:1000) LG4[j,] <- sample(x2, 36, replace = FALSE, prob = NULL)
histLG4 <- vector()
for (i in 1:1000) histLG4[i] <- length(LG4[i,][LG5[i,]>5.991])
hist(histLG4)
abline(v=9,col="red")

LG5 <- matrix(0, nrow=1000, ncol = 40)
for (j in 1:1000) LG5[j,] <- sample(x2, 40, replace = FALSE, prob = NULL)
histLG5 <- vector()
for (i in 1:1000) histLG5[i] <- length(LG5[i,][LG5[i,]>5.991])
hist(histLG5)
abline(v=2,col="red")

LG6 <- matrix(0, nrow=1000, ncol = 65)
for (j in 1:1000) LG6[j,] <- sample(x2, 65, replace = FALSE, prob = NULL)
histLG6 <- vector()
for (i in 1:1000) histLG6[i] <- length(LG6[i,][LG6[i,]>5.991])
hist(histLG6, xlim = c(0,25))
abline(v=0,col="red")

LG7 <- matrix(0, nrow=1000, ncol = 31)
for (j in 1:1000) LG7[j,] <- sample(x2, 31, replace = FALSE, prob = NULL)
histLG7 <- vector()
for (i in 1:1000) histLG7[i] <- length(LG7[i,][LG7[i,]>5.991])
hist(histLG7)
abline(v=6,col="red")

LG8 <- matrix(0, nrow=1000, ncol = 23)
for (j in 1:1000) LG8[j,] <- sample(x2, 23, replace = FALSE, prob = NULL)
histLG8 <- vector()
for (i in 1:1000) histLG8[i] <- length(LG8[i,][LG7[i,]>5.991])
hist(histLG8, xlim = c(0,13))
abline(v=0,col="red")

LG9 <- matrix(0, nrow=1000, ncol = 50)
for (j in 1:1000) LG9[j,] <- sample(x2, 50, replace = FALSE, prob = NULL)
histLG9 <- vector()
for (i in 1:1000) histLG9[i] <- length(LG9[i,][LG9[i,]>5.991])
hist(histLG9, , xlim = c(0,20))
abline(v=1,col="red")

LG10 <- matrix(0, nrow=1000, ncol = 36)
for (j in 1:1000) LG10[j,] <- sample(x2, 36, replace = FALSE, prob = NULL)
histLG10 <- vector()
for (i in 1:1000) histLG10[i] <- length(LG10[i,][LG10[i,]>5.991])
hist(histLG10)
abline(v=1,col="red")

LG11 <- matrix(0, nrow=1000, ncol = 51)
for (j in 1:1000) LG11[j,] <- sample(x2, 51, replace = FALSE, prob = NULL)
histLG11 <- vector()
for (i in 1:1000) histLG11[i] <- length(LG11[i,][LG11[i,]>5.991])
hist(histLG11)
abline(v=4,col="red")

LG12 <- matrix(0, nrow=1000, ncol = 53)
for (j in 1:1000) LG12[j,] <- sample(x2, 53, replace = FALSE, prob = NULL)
histLG12 <- vector()
for (i in 1:1000) histLG12[i] <- length(LG12[i,][LG12[i,]>5.991])
hist(histLG12)
abline(v=3,col="red")

LG13 <- matrix(0, nrow=1000, ncol = 28)
for (j in 1:1000) LG13[j,] <- sample(x2, 28, replace = FALSE, prob = NULL)
histLG13 <- vector()
for (i in 1:1000) histLG13[i] <- length(LG13[i,][LG13[i,]>5.991])
hist(histLG13, xlim=c(0,16), main = "")
abline(v=15,col="red")

LG14 <- matrix(0, nrow=1000, ncol = 42)
for (j in 1:1000) LG14[j,] <- sample(x2, 42, replace = FALSE, prob = NULL)
histLG14 <- vector()
for (i in 1:1000) histLG14[i] <- length(LG14[i,][LG14[i,]>5.991])
hist(histLG14)
abline(v=13,col="red")

LG15 <- matrix(0, nrow=1000, ncol = 46)
for (j in 1:1000) LG15[j,] <- sample(x2, 46, replace = FALSE, prob = NULL)
histLG15 <- vector()
for (i in 1:1000) histLG15[i] <- length(LG15[i,][LG5[i,]>5.991])
hist(histLG15)
abline(v=3,col="red")

LG16 <- matrix(0, nrow=1000, ncol = 48)
for (j in 1:1000) LG16[j,] <- sample(x2, 48, replace = FALSE, prob = NULL)
histLG16 <- vector()
for (i in 1:1000) histLG16[i] <- length(LG16[i,][LG16[i,]>5.991])
hist(histLG16)
abline(v=6,col="red")

LG15 <- matrix(0, nrow=1000, ncol = 46)
for (j in 1:1000) LG15[j,] <- sample(x2, 46, replace = FALSE, prob = NULL)
histLG15 <- vector()
for (i in 1:1000) histLG15[i] <- length(LG15[i,][LG15[i,]>5.991])
hist(histLG15)
abline(v=3,col="red")

LG17 <- matrix(0, nrow=1000, ncol = 90)
for (j in 1:1000) LG17[j,] <- sample(x2, 90, replace = FALSE, prob = NULL)
histLG17 <- vector()
for (i in 1:1000) histLG17[i] <- length(LG17[i,][LG17[i,]>5.991])
hist(histLG17, xlim=c(5,46), main = "")
abline(v=45,col="red")

LG18 <- matrix(0, nrow=1000, ncol = 71)
for (j in 1:1000) LG18[j,] <- sample(x2, 71, replace = FALSE, prob = NULL)
histLG18 <- vector()
for (i in 1:1000) histLG18[i] <- length(LG18[i,][LG18[i,]>5.991])
hist(histLG18)
abline(v=13,col="red")

LG19 <- matrix(0, nrow=1000, ncol = 27)
for (j in 1:1000) LG19[j,] <- sample(x2, 27, replace = FALSE, prob = NULL)
histLG19 <- vector()
for (i in 1:1000) histLG19[i] <- length(LG19[i,][LG19[i,]>5.991])
hist(histLG19)
abline(v=4,col="red")

LG20 <- matrix(0, nrow=1000, ncol = 58)
for (j in 1:1000) LG20[j,] <- sample(x2, 58, replace = FALSE, prob = NULL)
histLG20 <- vector()
for (i in 1:1000) histLG20[i] <- length(LG20[i,][LG20[i,]>5.991])
hist(histLG20)
abline(v=11,col="red")

LG21 <- matrix(0, nrow=1000, ncol = 49)
for (j in 1:1000) LG21[j,] <- sample(x2, 49, replace = FALSE, prob = NULL)
histLG21 <- vector()
for (i in 1:1000) histLG21[i] <- length(LG21[i,][LG21[i,]>5.991])
hist(histLG21)
abline(v=4,col="red")

LG22 <- matrix(0, nrow=1000, ncol = 46)
for (j in 1:1000) LG22[j,] <- sample(x2, 46, replace = FALSE, prob = NULL)
histLG22 <- vector()
for (i in 1:1000) histLG22[i] <- length(LG22[i,][LG22[i,]>5.991])
hist(histLG22)
abline(v=15,col="red")

LG23 <- matrix(0, nrow=1000, ncol = 23)
for (j in 1:1000) LG23[j,] <- sample(x2, 23, replace = FALSE, prob = NULL)
histLG23 <- vector()
for (i in 1:1000) histLG23[i] <- length(LG23[i,][LG23[i,]>5.991])
hist(histLG23)
abline(v=0,col="red")

LG24 <- matrix(0, nrow=1000, ncol = 39)
for (j in 1:1000) LG24[j,] <- sample(x2, 39, replace = FALSE, prob = NULL)
histLG24 <- vector()
for (i in 1:1000) histLG24[i] <- length(LG24[i,][LG24[i,]>5.991])
hist(histLG24)
abline(v=4,col="red")

LG25 <- matrix(0, nrow=1000, ncol = 26)
for (j in 1:1000) LG25[j,] <- sample(x2, 26, replace = FALSE, prob = NULL)
histLG25 <- vector()
for (i in 1:1000) histLG25[i] <- length(LG25[i,][LG25[i,]>5.991])
hist(histLG25)
abline(v=2,col="red")

LG26 <- matrix(0, nrow=1000, ncol = 41)
for (j in 1:1000) LG26[j,] <- sample(x2, 41, replace = FALSE, prob = NULL)
histLG26 <- vector()
for (i in 1:1000) histLG26[i] <- length(LG26[i,][LG26[i,]>5.991])
hist(histLG26)
abline(v=6,col="red")

LG27 <- matrix(0, nrow=1000, ncol = 49)
for (j in 1:1000) LG27[j,] <- sample(x2, 49, replace = FALSE, prob = NULL)
histLG27 <- vector()
for (i in 1:1000) histLG27[i] <- length(LG27[i,][LG27[i,]>5.991])
hist(histLG27)
abline(v=17,col="red")

LG28 <- matrix(0, nrow=1000, ncol = 38)
for (j in 1:1000) LG28[j,] <- sample(x2, 38, replace = FALSE, prob = NULL)
histLG28 <- vector()
for (i in 1:1000) histLG28[i] <- length(LG28[i,][LG28[i,]>5.991])
hist(histLG28)
abline(v=5,col="red")

LG29 <- matrix(0, nrow=1000, ncol = 39)
for (j in 1:1000) LG29[j,] <- sample(x2, 39, replace = FALSE, prob = NULL)
histLG29 <- vector()
for (i in 1:1000) histLG29[i] <- length(LG29[i,][LG29[i,]>5.991])
hist(histLG29, xlim = c(0,16))
abline(v=0,col="red")

LG30 <- matrix(0, nrow=1000, ncol = 9)
for (j in 1:1000) LG30[j,] <- sample(x2, 9, replace = FALSE, prob = NULL)
histLG30 <- vector()
for (i in 1:1000) histLG30[i] <- length(LG30[i,][LG30[i,]>5.991])
hist(histLG30)
abline(v=2,col="red")

LG31 <- matrix(0, nrow=1000, ncol = 9)
for (j in 1:1000) LG31[j,] <- sample(x2, 9, replace = FALSE, prob = NULL)
histLG31 <- vector()
for (i in 1:1000) histLG31[i] <- length(LG31[i,][LG31[i,]>5.991])
hist(histLG31, xlim = c(-1,10), main = "")
abline(v=8,col="red")

LG32 <- matrix(0, nrow=1000, ncol = 5)
for (j in 1:1000) LG32[j,] <- sample(x2, 5, replace = FALSE, prob = NULL)
histLG32 <- vector()
for (i in 1:1000) histLG32[i] <- length(LG32[i,][LG32[i,]>5.991])
hist(histLG32, xlim = c(-1,10))
abline(v=2,col="red")

```

Linkage groups 13, 17 and 31 have more markers under segregation distortion that expected by chance

Now we are going to check whether or not those markers under segregation distortion are grouped together within the linkage groups.

And first, we will check again whether or not for these specific linkage groups there is any king of correlation between missing data and segregation distortion.

```{r}

x2.all <- mydata[,2]

LG31 <- read.csv(file = "LG31.csv")
x2 <- LG31[,3]
missingdata <- LG31[,4]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")
LG31MATRIX1000 <- matrix(0,9,1000)
LG31.1000 <- cbind(LG31,LG31MATRIX1000)
for (i in 5:1004) LG31.1000[,i] <- sample(x2.all, 9, replace = FALSE, prob = NULL)

LG17 <- read.csv(file = "LG17.csv")
x2 <- LG17[,3]
missingdata <- LG17[,4]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")
LG17MATRIX1000 <- matrix(0,90,1000)
LG17.1000 <- cbind(LG17,LG17MATRIX1000)
for (i in 5:1004) LG17.1000[,i] <- sample(x2.all, 90, replace = FALSE, prob = NULL)

LG13 <- read.csv(file = "LG13.csv")
x2 <- LG13[,3]
missingdata <- LG13[,4]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")
LG13MATRIX1000 <- matrix(0,28,1000)
LG13.1000 <- cbind(LG13,LG13MATRIX1000)
for (i in 5:1004) LG13.1000[,i] <- sample(x2.all, 28, replace = FALSE, prob = NULL)

LG31CIsup <- vector()
LG31$CIsup <- 5.991
LG31$CIinf <- 0

library(ggplot2)
p31 <- ggplot(LG31, aes(POSITION))+
  geom_line(data=subset(LG31),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG31),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG31),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG31),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p31

LG17CIsup <- vector()
LG17$CIsup <- 5.991
LG17$CIinf <- 0

p17 <- ggplot(LG17, aes(POSITION))+
  geom_line(data=subset(LG17),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG17),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG17),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG17),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p17

LG13CIsup <- vector()
LG13$CIsup <- 5.991
LG13$CIinf <- 0

p13 <- ggplot(LG13, aes(POSITION))+
  geom_line(data=subset(LG13),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG13),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG13),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG13),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p13


library(adehabitat)
wawotest(as.numeric(LG31$CHISQUARE > 5.991))
wawotest(as.numeric(LG17$CHISQUARE > 5.991))
wawotest(as.numeric(LG13$CHISQUARE > 5.991))

```

Now we are going to repeat the last analysis for LG17 and LG13 but excluding the loci that are not safely located

```{r}
LG17red <- read.csv(file = "LG17.red.csv")
LG17red$CIsup <- 5.991
LG17red$CIinf <- 0

p17red <- ggplot(LG17red, aes(POSITION))+
  geom_line(data=subset(LG17red),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG17red),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG17red),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG17red),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p17red

LG13red <- read.csv(file = "LG13.red.csv")
LG13red$CIsup <- 5.991
LG13red$CIinf <- 0

p13red <- ggplot(LG13red, aes(POSITION))+
  geom_line(data=subset(LG13red),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG13red),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG13red),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG13red),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p13red


library(adehabitat)
wawotest(as.numeric(LG17red$CHISQUARE > 5.991))
wawotest(as.numeric(LG13$CHISQUARE > 5.991))

```


########################################################
We are going to repeat the process but including the 85 loci under severe segregation distortion

First, we load the package onemap and import the data set

```{r}

library (onemap)

f2.onemap.sd <- read_mapmaker(file = "onemap.f2.sd.txt")

```

Second, we assign markers to linkage groups

```{r}
twopts.sd <- rf_2pts(f2.onemap.sd, LOD=3, max.rf=0.5)
mark.all.sd <- make_seq(twopts.sd, "all")
LGs.f2.6.0.5.sd <- group(mark.all.sd, LOD = 6, max.rf = 0.5)
LGs.f2.6.0.5.sd 
```

Third, we get the genetic mapping of linkage groups

```{r}
set_map_fun(type="kosambi")

LG.f2.6.0.5.1.sd <- make_seq(LGs.f2.6.0.5.sd, 1)
LG.f2.6.0.5.2.sd <- make_seq(LGs.f2.6.0.5.sd, 2)
LG.f2.6.0.5.3.sd <- make_seq(LGs.f2.6.0.5.sd, 3)
LG.f2.6.0.5.4.sd <- make_seq(LGs.f2.6.0.5.sd, 4)
LG.f2.6.0.5.5.sd <- make_seq(LGs.f2.6.0.5.sd, 5)
LG.f2.6.0.5.6.sd <- make_seq(LGs.f2.6.0.5.sd, 6)
LG.f2.6.0.5.7.sd <- make_seq(LGs.f2.6.0.5.sd, 7)
LG.f2.6.0.5.8.sd <- make_seq(LGs.f2.6.0.5.sd, 8)
LG.f2.6.0.5.9.sd <- make_seq(LGs.f2.6.0.5.sd, 9)
LG.f2.6.0.5.10.sd <- make_seq(LGs.f2.6.0.5.sd, 10)
LG.f2.6.0.5.11.sd <- make_seq(LGs.f2.6.0.5.sd, 11)
LG.f2.6.0.5.12.sd <- make_seq(LGs.f2.6.0.5.sd, 12)
LG.f2.6.0.5.13.sd <- make_seq(LGs.f2.6.0.5.sd, 13)
LG.f2.6.0.5.14.sd <- make_seq(LGs.f2.6.0.5.sd, 14)
LG.f2.6.0.5.15.sd <- make_seq(LGs.f2.6.0.5.sd, 15)
LG.f2.6.0.5.16.sd <- make_seq(LGs.f2.6.0.5.sd, 16)
LG.f2.6.0.5.17.sd <- make_seq(LGs.f2.6.0.5.sd, 17)
LG.f2.6.0.5.18.sd <- make_seq(LGs.f2.6.0.5.sd, 18)
LG.f2.6.0.5.19.sd <- make_seq(LGs.f2.6.0.5.sd, 19)
LG.f2.6.0.5.20.sd <- make_seq(LGs.f2.6.0.5.sd, 20)
LG.f2.6.0.5.21.sd <- make_seq(LGs.f2.6.0.5.sd, 21)
LG.f2.6.0.5.22.sd <- make_seq(LGs.f2.6.0.5.sd, 22)
LG.f2.6.0.5.23.sd <- make_seq(LGs.f2.6.0.5.sd, 23)
LG.f2.6.0.5.24.sd <- make_seq(LGs.f2.6.0.5.sd, 24)
LG.f2.6.0.5.25.sd <- make_seq(LGs.f2.6.0.5.sd, 25)
LG.f2.6.0.5.26.sd <- make_seq(LGs.f2.6.0.5.sd, 26)
LG.f2.6.0.5.27.sd <- make_seq(LGs.f2.6.0.5.sd, 27)
LG.f2.6.0.5.28.sd <- make_seq(LGs.f2.6.0.5.sd, 28)
LG.f2.6.0.5.29.sd <- make_seq(LGs.f2.6.0.5.sd, 29)
LG.f2.6.0.5.30.sd <- make_seq(LGs.f2.6.0.5.sd, 30)
LG.f2.6.0.5.31.sd <- make_seq(LGs.f2.6.0.5.sd, 31)




LG.f2.6.0.5.1.ord.sd <- order_seq(LG.f2.6.0.5.1.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.2.ord.sd <- order_seq(LG.f2.6.0.5.2.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.3.ord.sd <- order_seq(LG.f2.6.0.5.3.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.4.ord.sd <- order_seq(LG.f2.6.0.5.4.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.5.ord.sd <- order_seq(LG.f2.6.0.5.5.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.6.ord.sd <- order_seq(LG.f2.6.0.5.6.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.7.ord.sd <- order_seq(LG.f2.6.0.5.7.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.8.ord.sd <- order_seq(LG.f2.6.0.5.8.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.9.ord.sd <- order_seq(LG.f2.6.0.5.9.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.10.ord.sd <- order_seq(LG.f2.6.0.5.10.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.11.ord.sd <- order_seq(LG.f2.6.0.5.11.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.12.ord.sd <- order_seq(LG.f2.6.0.5.12.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.13.ord.sd <- order_seq(LG.f2.6.0.5.13.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.14.ord.sd <- order_seq(LG.f2.6.0.5.14.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.15.ord.sd <- order_seq(LG.f2.6.0.5.15.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.16.ord.sd <- order_seq(LG.f2.6.0.5.16.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.17.ord.sd <- order_seq(LG.f2.6.0.5.17.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.18.ord.sd <- order_seq(LG.f2.6.0.5.18.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.19.ord.sd <- order_seq(LG.f2.6.0.5.19.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.20.ord.sd <- order_seq(LG.f2.6.0.5.20.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.21.ord.sd <- order_seq(LG.f2.6.0.5.21.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.22.ord.sd <- order_seq(LG.f2.6.0.5.22.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.23.ord.sd <- order_seq(LG.f2.6.0.5.23.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.24.ord.sd <- order_seq(LG.f2.6.0.5.24.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.25.ord.sd <- order_seq(LG.f2.6.0.5.25.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.26.ord.sd <- order_seq(LG.f2.6.0.5.26.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.27.ord.sd <- order_seq(LG.f2.6.0.5.27.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.28.ord.sd <- order_seq(LG.f2.6.0.5.28.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.29.ord.sd <- order_seq(LG.f2.6.0.5.29.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.30.ord.sd <- order_seq(LG.f2.6.0.5.30.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)
LG.f2.6.0.5.31.ord.sd <- order_seq(LG.f2.6.0.5.31.sd, n.init=5, subset.search = "twopt", twopt.alg = "rcd", THRES = 3)


```

Now, we order the markers, all of them and only the safe ones

```{r}
LG.f2.6.0.5.1.ord.safe.sd <- make_seq(LG.f2.6.0.5.1.ord.sd,"safe")
LG.f2.6.0.5.2.ord.safe.sd <- make_seq(LG.f2.6.0.5.2.ord.sd,"safe")
LG.f2.6.0.5.3.ord.safe.sd <- make_seq(LG.f2.6.0.5.3.ord.sd,"safe")
LG.f2.6.0.5.4.ord.safe.sd <- make_seq(LG.f2.6.0.5.4.ord.sd,"safe")
LG.f2.6.0.5.5.ord.safe.sd <- make_seq(LG.f2.6.0.5.5.ord.sd,"safe")
LG.f2.6.0.5.6.ord.safe.sd <- make_seq(LG.f2.6.0.5.6.ord.sd,"safe")
LG.f2.6.0.5.7.ord.safe.sd <- make_seq(LG.f2.6.0.5.7.ord.sd,"safe")
LG.f2.6.0.5.8.ord.safe.sd <- make_seq(LG.f2.6.0.5.8.ord.sd,"safe")
LG.f2.6.0.5.9.ord.safe.sd <- make_seq(LG.f2.6.0.5.9.ord.sd,"safe")
LG.f2.6.0.5.10.ord.safe.sd <- make_seq(LG.f2.6.0.5.10.ord.sd,"safe")
LG.f2.6.0.5.11.ord.safe.sd <- make_seq(LG.f2.6.0.5.11.ord.sd,"safe")
LG.f2.6.0.5.12.ord.safe.sd <- make_seq(LG.f2.6.0.5.12.ord.sd,"safe")
LG.f2.6.0.5.13.ord.safe.sd <- make_seq(LG.f2.6.0.5.13.ord.sd,"safe")
LG.f2.6.0.5.14.ord.safe.sd <- make_seq(LG.f2.6.0.5.14.ord.sd,"safe")
LG.f2.6.0.5.15.ord.safe.sd <- make_seq(LG.f2.6.0.5.15.ord.sd,"safe")
LG.f2.6.0.5.16.ord.safe.sd <- make_seq(LG.f2.6.0.5.16.ord.sd,"safe")
LG.f2.6.0.5.17.ord.safe.sd <- make_seq(LG.f2.6.0.5.17.ord.sd,"safe")
LG.f2.6.0.5.18.ord.safe.sd <- make_seq(LG.f2.6.0.5.18.ord.sd,"safe")
LG.f2.6.0.5.19.ord.safe.sd <- make_seq(LG.f2.6.0.5.19.ord.sd,"safe")
LG.f2.6.0.5.20.ord.safe.sd <- make_seq(LG.f2.6.0.5.20.ord.sd,"safe")
LG.f2.6.0.5.21.ord.safe.sd <- make_seq(LG.f2.6.0.5.21.ord.sd,"safe")
LG.f2.6.0.5.22.ord.safe.sd <- make_seq(LG.f2.6.0.5.22.ord.sd,"safe")
LG.f2.6.0.5.23.ord.safe.sd <- make_seq(LG.f2.6.0.5.23.ord.sd,"safe")
LG.f2.6.0.5.24.ord.safe.sd <- make_seq(LG.f2.6.0.5.24.ord.sd,"safe")
LG.f2.6.0.5.25.ord.safe.sd <- make_seq(LG.f2.6.0.5.25.ord.sd,"safe")
LG.f2.6.0.5.26.ord.safe.sd <- make_seq(LG.f2.6.0.5.26.ord.sd,"safe")
LG.f2.6.0.5.27.ord.safe.sd <- make_seq(LG.f2.6.0.5.27.ord.sd,"safe")
LG.f2.6.0.5.28.ord.safe.sd <- make_seq(LG.f2.6.0.5.28.ord.sd,"safe")
LG.f2.6.0.5.29.ord.safe.sd <- make_seq(LG.f2.6.0.5.29.ord.sd,"safe")
LG.f2.6.0.5.30.ord.safe.sd <- make_seq(LG.f2.6.0.5.30.ord.sd,"safe")
LG.f2.6.0.5.31.ord.safe.sd <- make_seq(LG.f2.6.0.5.31.ord.sd,"safe")

LG.f2.6.0.5.1.ord.all.sd <- make_seq(LG.f2.6.0.5.1.ord.sd,"force")
LG.f2.6.0.5.2.ord.all.sd <- make_seq(LG.f2.6.0.5.2.ord.sd,"force")
LG.f2.6.0.5.3.ord.all.sd <- make_seq(LG.f2.6.0.5.3.ord.sd,"force")
LG.f2.6.0.5.4.ord.all.sd <- make_seq(LG.f2.6.0.5.4.ord.sd,"force")
LG.f2.6.0.5.5.ord.all.sd <- make_seq(LG.f2.6.0.5.5.ord.sd,"force")
LG.f2.6.0.5.6.ord.all.sd <- make_seq(LG.f2.6.0.5.6.ord.sd,"force")
LG.f2.6.0.5.7.ord.all.sd <- make_seq(LG.f2.6.0.5.7.ord.sd,"force")
LG.f2.6.0.5.8.ord.all.sd <- make_seq(LG.f2.6.0.5.8.ord.sd,"force")
LG.f2.6.0.5.9.ord.all.sd <- make_seq(LG.f2.6.0.5.9.ord.sd,"force")
LG.f2.6.0.5.10.ord.all.sd <- make_seq(LG.f2.6.0.5.10.ord.sd,"force")
LG.f2.6.0.5.11.ord.all.sd <- make_seq(LG.f2.6.0.5.11.ord.sd,"force")
LG.f2.6.0.5.12.ord.all.sd <- make_seq(LG.f2.6.0.5.12.ord.sd,"force")
LG.f2.6.0.5.13.ord.all.sd <- make_seq(LG.f2.6.0.5.13.ord.sd,"force")
LG.f2.6.0.5.14.ord.all.sd <- make_seq(LG.f2.6.0.5.14.ord.sd,"force")
LG.f2.6.0.5.15.ord.all.sd <- make_seq(LG.f2.6.0.5.15.ord.sd,"force")
LG.f2.6.0.5.16.ord.all.sd <- make_seq(LG.f2.6.0.5.16.ord.sd,"force")
LG.f2.6.0.5.17.ord.all.sd <- make_seq(LG.f2.6.0.5.17.ord.sd,"force")
LG.f2.6.0.5.18.ord.all.sd <- make_seq(LG.f2.6.0.5.18.ord.sd,"force")
LG.f2.6.0.5.19.ord.all.sd <- make_seq(LG.f2.6.0.5.19.ord.sd,"force")
LG.f2.6.0.5.20.ord.all.sd <- make_seq(LG.f2.6.0.5.20.ord.sd,"force")
LG.f2.6.0.5.21.ord.all.sd <- make_seq(LG.f2.6.0.5.21.ord.sd,"force")
LG.f2.6.0.5.22.ord.all.sd <- make_seq(LG.f2.6.0.5.22.ord.sd,"force")
LG.f2.6.0.5.23.ord.all.sd <- make_seq(LG.f2.6.0.5.23.ord.sd,"force")
LG.f2.6.0.5.24.ord.all.sd <- make_seq(LG.f2.6.0.5.24.ord.sd,"force")
LG.f2.6.0.5.25.ord.all.sd <- make_seq(LG.f2.6.0.5.25.ord.sd,"force")
LG.f2.6.0.5.26.ord.all.sd <- make_seq(LG.f2.6.0.5.26.ord.sd,"force")
LG.f2.6.0.5.27.ord.all.sd <- make_seq(LG.f2.6.0.5.27.ord.sd,"force")
LG.f2.6.0.5.28.ord.all.sd <- make_seq(LG.f2.6.0.5.28.ord.sd,"force")
LG.f2.6.0.5.29.ord.all.sd <- make_seq(LG.f2.6.0.5.29.ord.sd,"force")
LG.f2.6.0.5.30.ord.all.sd <- make_seq(LG.f2.6.0.5.30.ord.sd,"force")
LG.f2.6.0.5.31.ord.all.sd <- make_seq(LG.f2.6.0.5.31.ord.sd,"force")

```

Drawing the genetic map

```{r}
Map.6.0.5.ord.safe.sd <- list(
LG.f2.6.0.5.1.ord.safe.sd, 
LG.f2.6.0.5.2.ord.safe.sd, 
LG.f2.6.0.5.3.ord.safe.sd, 
LG.f2.6.0.5.4.ord.safe.sd, 
LG.f2.6.0.5.5.ord.safe.sd, 
LG.f2.6.0.5.6.ord.safe.sd, 
LG.f2.6.0.5.7.ord.safe.sd, 
LG.f2.6.0.5.8.ord.safe.sd, 
LG.f2.6.0.5.9.ord.safe.sd, 
LG.f2.6.0.5.10.ord.safe.sd,
LG.f2.6.0.5.11.ord.safe.sd,
LG.f2.6.0.5.12.ord.safe.sd,
LG.f2.6.0.5.13.ord.safe.sd,
LG.f2.6.0.5.14.ord.safe.sd,
LG.f2.6.0.5.15.ord.safe.sd,
LG.f2.6.0.5.16.ord.safe.sd,
LG.f2.6.0.5.17.ord.safe.sd,
LG.f2.6.0.5.18.ord.safe.sd,
LG.f2.6.0.5.19.ord.safe.sd,
LG.f2.6.0.5.20.ord.safe.sd,
LG.f2.6.0.5.21.ord.safe.sd,
LG.f2.6.0.5.22.ord.safe.sd,
LG.f2.6.0.5.23.ord.safe.sd,
LG.f2.6.0.5.24.ord.safe.sd,
LG.f2.6.0.5.25.ord.safe.sd,
LG.f2.6.0.5.26.ord.safe.sd,
LG.f2.6.0.5.27.ord.safe.sd,
LG.f2.6.0.5.28.ord.safe.sd,
LG.f2.6.0.5.29.ord.safe.sd,
LG.f2.6.0.5.30.ord.safe.sd,
LG.f2.6.0.5.31.ord.safe.sd)

Map.6.0.5.ord.all.sd <- list(
LG.f2.6.0.5.1.ord.all.sd, 
LG.f2.6.0.5.2.ord.all.sd, 
LG.f2.6.0.5.3.ord.all.sd, 
LG.f2.6.0.5.4.ord.all.sd, 
LG.f2.6.0.5.5.ord.all.sd, 
LG.f2.6.0.5.6.ord.all.sd, 
LG.f2.6.0.5.7.ord.all.sd, 
LG.f2.6.0.5.8.ord.all.sd, 
LG.f2.6.0.5.9.ord.all.sd, 
LG.f2.6.0.5.10.ord.all.sd,
LG.f2.6.0.5.11.ord.all.sd,
LG.f2.6.0.5.12.ord.all.sd,
LG.f2.6.0.5.13.ord.all.sd,
LG.f2.6.0.5.14.ord.all.sd,
LG.f2.6.0.5.15.ord.all.sd,
LG.f2.6.0.5.16.ord.all.sd,
LG.f2.6.0.5.17.ord.all.sd,
LG.f2.6.0.5.18.ord.all.sd,
LG.f2.6.0.5.19.ord.all.sd,
LG.f2.6.0.5.20.ord.all.sd,
LG.f2.6.0.5.21.ord.all.sd,
LG.f2.6.0.5.22.ord.all.sd,
LG.f2.6.0.5.23.ord.all.sd,
LG.f2.6.0.5.24.ord.all.sd,
LG.f2.6.0.5.25.ord.all.sd,
LG.f2.6.0.5.26.ord.all.sd,
LG.f2.6.0.5.27.ord.all.sd,
LG.f2.6.0.5.28.ord.all.sd,
LG.f2.6.0.5.29.ord.all.sd,
LG.f2.6.0.5.30.ord.all.sd,
LG.f2.6.0.5.31.ord.all.sd)

pdf("Map.6.0.5.ord.safe.sd.pdf")
draw_map(Map.6.0.5.ord.safe.sd, names= TRUE, grid=TRUE, cex.mrk=0.3)
dev.off()

pdf("Map.6.0.5.ord.all.sd.pdf")
draw_map(Map.6.0.5.ord.all.sd, names= TRUE, grid=TRUE, cex.mrk=0.3)
dev.off()

```


NOTE: This map is suboptimal because we have include many loci (85) under severe segregation distorion. So we are not going to "clean" the LGs as we did with the previous map. 

Now we are going to look for linkage groups with a higher number than markers under segregation distortion that what would be expected by chance.
But first we will check wether or not there is a correlation between missing data and segregation distortion.

```{r}

mydata.sd <- read.csv(file="permutations2.csv")
mydata.sd
mydata.sd[,1] <- paste("M",mydata.sd[,1], sep="")

x2.sd <- mydata.sd[,2]
missingdata.sd <- mydata.sd[,3]
summary(lm(x2.sd ~ missingdata.sd))
plot(x2.sd ~ missingdata.sd, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")

mydata.sd[,4] <- seq(1:1427)

LG1.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.1.ord.all.sd$seq.num),]
LG1.sd
nrow(LG1.sd)
LG1.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG1.sd))
for (j in 1:1000) LG1.per.sd[j,] <- sample(x2.sd, nrow(LG1.sd), replace = FALSE, prob = NULL)
histLG1.sd <- vector()
for (i in 1:1000) histLG1.sd[i] <- length(LG1.per.sd[i,][LG1.per.sd[i,]>5.991])
hist(histLG1.sd)
abline(v=length(LG1.sd[,2][LG1.sd[,2]>5.991]),col="red")
length(LG1.sd[,2][LG1.sd[,2]>13.5])

LG2.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.2.ord.all.sd$seq.num),]
LG2.sd
nrow(LG2.sd)
LG2.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG2.sd))
for (j in 1:1000) LG2.per.sd[j,] <- sample(x2.sd, nrow(LG2.sd), replace = FALSE, prob = NULL)
histLG2.sd <- vector()
for (i in 1:1000) histLG2.sd[i] <- length(LG2.per.sd[i,][LG2.per.sd[i,]>5.991])
hist(histLG2.sd)
abline(v=length(LG2.sd[,2][LG2.sd[,2]>5.991]),col="red")
length(LG2.sd[,2][LG2.sd[,2]>13.5])

LG3.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.3.ord.all.sd$seq.num),]
LG3.sd
nrow(LG3.sd)
LG3.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG3.sd))
for (j in 1:1000) LG3.per.sd[j,] <- sample(x2.sd, nrow(LG3.sd), replace = FALSE, prob = NULL)
histLG3.sd <- vector()
for (i in 1:1000) histLG3.sd[i] <- length(LG3.per.sd[i,][LG3.per.sd[i,]>5.991])
hist(histLG3.sd)
abline(v=length(LG3.sd[,2][LG3.sd[,2]>5.991]),col="red")
length(LG3.sd[,2][LG3.sd[,2]>13.5])


LG4.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.4.ord.all.sd$seq.num),]
LG4.sd
nrow(LG4.sd)
LG4.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG4.sd))
for (j in 1:1000) LG4.per.sd[j,] <- sample(x2.sd, nrow(LG4.sd), replace = FALSE, prob = NULL)
histLG4.sd <- vector()
for (i in 1:1000) histLG4.sd[i] <- length(LG4.per.sd[i,][LG4.per.sd[i,]>5.991])
hist(histLG4.sd, xlim = c(0,60))
abline(v=length(LG4.sd[,2][LG4.sd[,2]>5.991]),col="red")
length(LG4.sd[,2][LG4.sd[,2]>13.5])

LG5.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.5.ord.all.sd$seq.num),]
LG5.sd
nrow(LG5.sd)
LG5.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG5.sd))
for (j in 1:1000) LG5.per.sd[j,] <- sample(x2.sd, nrow(LG5.sd), replace = FALSE, prob = NULL)
histLG5.sd <- vector()
for (i in 1:1000) histLG5.sd[i] <- length(LG5.per.sd[i,][LG5.per.sd[i,]>5.991])
hist(histLG5.sd)
abline(v=length(LG5.sd[,2][LG5.sd[,2]>5.991]),col="red")
length(LG5.sd[,2][LG5.sd[,2]>13.5])


LG6.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.6.ord.all.sd$seq.num),]
LG6.sd
nrow(LG6.sd)
LG6.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG6.sd))
for (j in 1:1000) LG6.per.sd[j,] <- sample(x2.sd, nrow(LG6.sd), replace = FALSE, prob = NULL)
histLG6.sd <- vector()
for (i in 1:1000) histLG6.sd[i] <- length(LG6.per.sd[i,][LG6.per.sd[i,]>5.991])
hist(histLG6.sd)
abline(v=length(LG6.sd[,2][LG6.sd[,2]>5.991]),col="red")
length(LG6.sd[,2][LG6.sd[,2]>13.5])


LG7.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.7.ord.all.sd$seq.num),]
LG7.sd
nrow(LG7.sd)
LG7.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG7.sd))
for (j in 1:1000) LG7.per.sd[j,] <- sample(x2.sd, nrow(LG7.sd), replace = FALSE, prob = NULL)
histLG7.sd <- vector()
for (i in 1:1000) histLG7.sd[i] <- length(LG7.per.sd[i,][LG7.per.sd[i,]>5.991])
hist(histLG7.sd)
abline(v=length(LG7.sd[,2][LG7.sd[,2]>5.991]),col="red")
length(LG7.sd[,2][LG7.sd[,2]>13.5])

LG8.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.8.ord.all.sd$seq.num),]
LG8.sd
nrow(LG8.sd)
LG8.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG8.sd))
for (j in 1:1000) LG8.per.sd[j,] <- sample(x2.sd, nrow(LG8.sd), replace = FALSE, prob = NULL)
histLG8.sd <- vector()
for (i in 1:1000) histLG8.sd[i] <- length(LG8.per.sd[i,][LG8.per.sd[i,]>5.991])
hist(histLG8.sd)
abline(v=length(LG8.sd[,2][LG8.sd[,2]>5.991]),col="red")
length(LG8.sd[,2][LG8.sd[,2]>13.5])

LG9.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.9.ord.all.sd$seq.num),]
LG9.sd
nrow(LG9.sd)
LG9.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG9.sd))
for (j in 1:1000) LG9.per.sd[j,] <- sample(x2.sd, nrow(LG9.sd), replace = FALSE, prob = NULL)
histLG9.sd <- vector()
for (i in 1:1000) histLG9.sd[i] <- length(LG9.per.sd[i,][LG9.per.sd[i,]>5.991])
hist(histLG9.sd, xlim = c(0,30))
abline(v=length(LG9.sd[,2][LG9.sd[,2]>5.991]),col="red")
length(LG9.sd[,2][LG9.sd[,2]>13.5])

LG10.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.10.ord.all.sd$seq.num),]
LG10.sd
nrow(LG10.sd)
LG10.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG10.sd))
for (j in 1:1000) LG10.per.sd[j,] <- sample(x2.sd, nrow(LG10.sd), replace = FALSE, prob = NULL)
histLG10.sd <- vector()
for (i in 1:1000) histLG10.sd[i] <- length(LG10.per.sd[i,][LG10.per.sd[i,]>5.991])
hist(histLG10.sd)
abline(v=length(LG10.sd[,2][LG10.sd[,2]>5.991]),col="red")
length(LG10.sd[,2][LG10.sd[,2]>13.5])

LG11.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.11.ord.all.sd$seq.num),]
LG11.sd
nrow(LG11.sd)
LG11.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG11.sd))
for (j in 1:1000) LG11.per.sd[j,] <- sample(x2.sd, nrow(LG11.sd), replace = FALSE, prob = NULL)
histLG11.sd <- vector()
for (i in 1:1000) histLG11.sd[i] <- length(LG11.per.sd[i,][LG11.per.sd[i,]>5.991])
hist(histLG11.sd)
abline(v=length(LG11.sd[,2][LG11.sd[,2]>5.991]),col="red")
length(LG11.sd[,2][LG11.sd[,2]>13.5])

LG12.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.12.ord.all.sd$seq.num),]
LG12.sd
nrow(LG12.sd)
LG12.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG12.sd))
for (j in 1:1000) LG12.per.sd[j,] <- sample(x2.sd, nrow(LG12.sd), replace = FALSE, prob = NULL)
histLG12.sd <- vector()
for (i in 1:1000) histLG12.sd[i] <- length(LG12.per.sd[i,][LG12.per.sd[i,]>5.991])
hist(histLG12.sd)
abline(v=length(LG12.sd[,2][LG12.sd[,2]>5.991]),col="red")
length(LG12.sd[,2][LG12.sd[,2]>13.5])

LG13.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.13.ord.all.sd$seq.num),]
LG13.sd
nrow(LG13.sd)
LG13.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG13.sd))
for (j in 1:1000) LG13.per.sd[j,] <- sample(x2.sd, nrow(LG13.sd), replace = FALSE, prob = NULL)
histLG13.sd <- vector()
for (i in 1:1000) histLG13.sd[i] <- length(LG13.per.sd[i,][LG13.per.sd[i,]>5.991])
hist(histLG13.sd, xlim = c(2,21))
abline(v=length(LG13.sd[,2][LG13.sd[,2]>5.991]),col="red")
length(LG13.sd[,2][LG13.sd[,2]>13.5])

LG14.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.14.ord.all.sd$seq.num),]
LG14.sd
nrow(LG14.sd)
LG14.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG14.sd))
for (j in 1:1000) LG14.per.sd[j,] <- sample(x2.sd, nrow(LG14.sd), replace = FALSE, prob = NULL)
histLG14.sd <- vector()
for (i in 1:1000) histLG14.sd[i] <- length(LG14.per.sd[i,][LG14.per.sd[i,]>5.991])
hist(histLG14.sd)
abline(v=length(LG14.sd[,2][LG14.sd[,2]>5.991]),col="red")
length(LG14.sd[,2][LG14.sd[,2]>13.5])

LG15.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.15.ord.all.sd$seq.num),]
LG15.sd
nrow(LG15.sd)
LG15.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG15.sd))
for (j in 1:1000) LG15.per.sd[j,] <- sample(x2.sd, nrow(LG15.sd), replace = FALSE, prob = NULL)
histLG15.sd <- vector()
for (i in 1:1000) histLG15.sd[i] <- length(LG15.per.sd[i,][LG15.per.sd[i,]>5.991])
hist(histLG15.sd)
abline(v=length(LG15.sd[,2][LG15.sd[,2]>5.991]),col="red")
length(LG15.sd[,2][LG15.sd[,2]>13.5])

LG16.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.16.ord.all.sd$seq.num),]
LG16.sd
nrow(LG16.sd)
LG16.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG16.sd))
for (j in 1:1000) LG16.per.sd[j,] <- sample(x2.sd, nrow(LG16.sd), replace = FALSE, prob = NULL)
histLG16.sd <- vector()
for (i in 1:1000) histLG16.sd[i] <- length(LG16.per.sd[i,][LG16.per.sd[i,]>5.991])
hist(histLG16.sd)
abline(v=length(LG16.sd[,2][LG16.sd[,2]>5.991]),col="red")
length(LG16.sd[,2][LG16.sd[,2]>13.5])

LG17.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.17.ord.all.sd$seq.num),]
LG17.sd
nrow(LG17.sd)
LG17.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG17.sd))
for (j in 1:1000) LG17.per.sd[j,] <- sample(x2.sd, nrow(LG17.sd), replace = FALSE, prob = NULL)
histLG17.sd <- vector()
for (i in 1:1000) histLG17.sd[i] <- length(LG17.per.sd[i,][LG17.per.sd[i,]>5.991])
hist(histLG17.sd, xlim = c(5,50))
abline(v=length(LG17.sd[,2][LG17.sd[,2]>5.991]),col="red")
length(LG17.sd[,2][LG17.sd[,2]>13.5])

LG18.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.18.ord.all.sd$seq.num),]
LG18.sd
nrow(LG18.sd)
LG18.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG18.sd))
for (j in 1:1000) LG18.per.sd[j,] <- sample(x2.sd, nrow(LG18.sd), replace = FALSE, prob = NULL)
histLG18.sd <- vector()
for (i in 1:1000) histLG18.sd[i] <- length(LG18.per.sd[i,][LG18.per.sd[i,]>5.991])
hist(histLG18.sd)
abline(v=length(LG18.sd[,2][LG18.sd[,2]>5.991]),col="red")
length(LG18.sd[,2][LG18.sd[,2]>13.5])

LG19.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.19.ord.all.sd$seq.num),]
LG19.sd
nrow(LG19.sd)
LG19.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG19.sd))
for (j in 1:1000) LG19.per.sd[j,] <- sample(x2.sd, nrow(LG19.sd), replace = FALSE, prob = NULL)
histLG19.sd <- vector()
for (i in 1:1000) histLG19.sd[i] <- length(LG19.per.sd[i,][LG19.per.sd[i,]>5.991])
hist(histLG19.sd)
abline(v=length(LG19.sd[,2][LG19.sd[,2]>5.991]),col="red")
length(LG19.sd[,2][LG19.sd[,2]>13.5])

LG20.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.20.ord.all.sd$seq.num),]
LG20.sd
nrow(LG20.sd)
LG20.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG20.sd))
for (j in 1:1000) LG20.per.sd[j,] <- sample(x2.sd, nrow(LG20.sd), replace = FALSE, prob = NULL)
histLG20.sd <- vector()
for (i in 1:1000) histLG20.sd[i] <- length(LG20.per.sd[i,][LG20.per.sd[i,]>5.991])
hist(histLG20.sd)
abline(v=length(LG20.sd[,2][LG20.sd[,2]>5.991]),col="red")
length(LG20.sd[,2][LG20.sd[,2]>13.5])

LG21.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.21.ord.all.sd$seq.num),]
LG21.sd
nrow(LG21.sd)
LG21.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG21.sd))
for (j in 1:1000) LG21.per.sd[j,] <- sample(x2.sd, nrow(LG21.sd), replace = FALSE, prob = NULL)
histLG21.sd <- vector()
for (i in 1:1000) histLG21.sd[i] <- length(LG21.per.sd[i,][LG21.per.sd[i,]>5.991])
hist(histLG21.sd)
abline(v=length(LG21.sd[,2][LG21.sd[,2]>5.991]),col="red")
length(LG21.sd[,2][LG21.sd[,2]>13.5])

LG22.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.22.ord.all.sd$seq.num),]
LG22.sd
nrow(LG22.sd)
LG22.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG22.sd))
for (j in 1:1000) LG22.per.sd[j,] <- sample(x2.sd, nrow(LG22.sd), replace = FALSE, prob = NULL)
histLG22.sd <- vector()
for (i in 1:1000) histLG22.sd[i] <- length(LG22.per.sd[i,][LG22.per.sd[i,]>5.991])
hist(histLG22.sd)
abline(v=length(LG22.sd[,2][LG22.sd[,2]>5.991]),col="red")
length(LG22.sd[,2][LG22.sd[,2]>13.5])

LG23.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.23.ord.all.sd$seq.num),]
LG23.sd
nrow(LG23.sd)
LG23.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG23.sd))
for (j in 1:1000) LG23.per.sd[j,] <- sample(x2.sd, nrow(LG23.sd), replace = FALSE, prob = NULL)
histLG23.sd <- vector()
for (i in 1:1000) histLG23.sd[i] <- length(LG23.per.sd[i,][LG23.per.sd[i,]>5.991])
hist(histLG23.sd, xlim=c(0,13))
abline(v=length(LG23.sd[,2][LG23.sd[,2]>5.991]),col="red")
length(LG23.sd[,2][LG23.sd[,2]>13.5])

LG24.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.24.ord.all.sd$seq.num),]
LG24.sd
nrow(LG24.sd)
LG24.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG24.sd))
for (j in 1:1000) LG24.per.sd[j,] <- sample(x2.sd, nrow(LG24.sd), replace = FALSE, prob = NULL)
histLG24.sd <- vector()
for (i in 1:1000) histLG24.sd[i] <- length(LG24.per.sd[i,][LG24.per.sd[i,]>5.991])
hist(histLG24.sd)
abline(v=length(LG24.sd[,2][LG24.sd[,2]>5.991]),col="red")
length(LG24.sd[,2][LG24.sd[,2]>13.5])

LG25.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.25.ord.all.sd$seq.num),]
LG25.sd
nrow(LG25.sd)
LG25.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG25.sd))
for (j in 1:1000) LG25.per.sd[j,] <- sample(x2.sd, nrow(LG25.sd), replace = FALSE, prob = NULL)
histLG25.sd <- vector()
for (i in 1:1000) histLG25.sd[i] <- length(LG25.per.sd[i,][LG25.per.sd[i,]>5.991])
hist(histLG25.sd)
abline(v=length(LG25.sd[,2][LG25.sd[,2]>5.991]),col="red")
length(LG25.sd[,2][LG25.sd[,2]>13.5])

LG26.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.26.ord.all.sd$seq.num),]
LG26.sd
nrow(LG26.sd)
LG26.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG26.sd))
for (j in 1:1000) LG26.per.sd[j,] <- sample(x2.sd, nrow(LG26.sd), replace = FALSE, prob = NULL)
histLG26.sd <- vector()
for (i in 1:1000) histLG26.sd[i] <- length(LG26.per.sd[i,][LG26.per.sd[i,]>5.991])
hist(histLG26.sd)
abline(v=length(LG26.sd[,2][LG26.sd[,2]>5.991]),col="red")
length(LG26.sd[,2][LG26.sd[,2]>13.5])

LG27.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.27.ord.all.sd$seq.num),]
LG27.sd
nrow(LG27.sd)
LG27.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG27.sd))
for (j in 1:1000) LG27.per.sd[j,] <- sample(x2.sd, nrow(LG27.sd), replace = FALSE, prob = NULL)
histLG27.sd <- vector()
for (i in 1:1000) histLG27.sd[i] <- length(LG27.per.sd[i,][LG27.per.sd[i,]>5.991])
hist(histLG27.sd)
abline(v=length(LG27.sd[,2][LG27.sd[,2]>5.991]),col="red")
length(LG27.sd[,2][LG27.sd[,2]>13.5])

LG28.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.28.ord.all.sd$seq.num),]
LG28.sd
nrow(LG28.sd)
LG28.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG28.sd))
for (j in 1:1000) LG28.per.sd[j,] <- sample(x2.sd, nrow(LG28.sd), replace = FALSE, prob = NULL)
histLG28.sd <- vector()
for (i in 1:1000) histLG28.sd[i] <- length(LG28.per.sd[i,][LG28.per.sd[i,]>5.991])
hist(histLG28.sd)
abline(v=length(LG28.sd[,2][LG28.sd[,2]>5.991]),col="red")
length(LG28.sd[,2][LG28.sd[,2]>13.5])

LG29.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.29.ord.all.sd$seq.num),]
LG29.sd
nrow(LG29.sd)
LG29.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG29.sd))
for (j in 1:1000) LG29.per.sd[j,] <- sample(x2.sd, nrow(LG29.sd), replace = FALSE, prob = NULL)
histLG29.sd <- vector()
for (i in 1:1000) histLG29.sd[i] <- length(LG29.per.sd[i,][LG29.per.sd[i,]>5.991])
hist(histLG29.sd)
abline(v=length(LG29.sd[,2][LG29.sd[,2]>5.991]),col="red")
length(LG29.sd[,2][LG29.sd[,2]>13.5])

LG30.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.30.ord.all.sd$seq.num),]
LG30.sd
nrow(LG30.sd)
LG30.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG30.sd))
for (j in 1:1000) LG30.per.sd[j,] <- sample(x2.sd, nrow(LG30.sd), replace = FALSE, prob = NULL)
histLG30.sd <- vector()
for (i in 1:1000) histLG30.sd[i] <- length(LG30.per.sd[i,][LG30.per.sd[i,]>5.991])
hist(histLG30.sd)
abline(v=length(LG30.sd[,2][LG30.sd[,2]>5.991]),col="red")
length(LG30.sd[,2][LG30.sd[,2]>13.5])

LG31.sd <- mydata.sd[intersect(mydata.sd[,4],LG.f2.6.0.5.31.ord.all.sd$seq.num),]
LG31.sd
nrow(LG31.sd)
LG31.per.sd <- matrix(0, nrow=1000, ncol = nrow(LG31.sd))
for (j in 1:1000) LG31.per.sd[j,] <- sample(x2.sd, nrow(LG31.sd), replace = FALSE, prob = NULL)
histLG31.sd <- vector()
for (i in 1:1000) histLG31.sd[i] <- length(LG31.per.sd[i,][LG31.per.sd[i,]>5.991])
hist(histLG31.sd)
abline(v=length(LG31.sd[,2][LG31.sd[,2]>5.991]),col="red")
length(LG31.sd[,2][LG31.sd[,2]>13.5])


```

Linkage groups 13, 17 and 31 (4 in this map) have more markers under segregation distortion that expected by chance

Now we are going to check whether or not those markers under segregation distortion are grouped together within the linkage groups.

And first, we will check again whether or not for these specific linkage groups there is any king of correlation between missing data and segregation distortion.

```{r}

x2 <- LG4.sd[,2]
missingdata <- LG4.sd[,3]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")

x2 <- LG17.sd[,2]
missingdata <- LG17.sd[,3]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")

x2 <- LG13.sd[,2]
missingdata <- LG13.sd[,3]
summary(lm(x2 ~ missingdata))
plot(x2 ~ missingdata, main="", xlab = "Number of individuals missing the marker", ylab = "Segregation distortion (X-square)")

LG13.pos <- read.csv("LG13.sd.csv")
setdiff(LG13.pos[,1],LG13.sd[,4])
setdiff(LG13.pos[,2],LG13.sd[,1])

library(ggplot2)
LG13.pos[,4] <- LG13.sd[,2][match(LG13.pos[,2],LG13.sd[,1])]
names(LG13.pos)[4] <- "CHISQUARE"
p13.sd <- ggplot(LG13.pos, aes(POSITION))+
  geom_line(data=subset(LG13.pos),aes(y=CHISQUARE),col="black", linetype="dotted")+
  geom_point(data=subset(LG13.pos),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 20))+
  geom_ribbon(data=subset(LG13.pos),aes(ymin=0,ymax=5.991),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG13.pos),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=20)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p13.sd

LG4.pos <- read.csv("LG4.sd.csv")
setdiff(LG4.pos[,1],LG4.sd[,4])
setdiff(LG4.pos[,2],LG4.sd[,1])

LG4.pos[,4] <- LG4.sd[,2][match(LG4.pos[,2],LG4.sd[,1])]
names(LG4.pos)[4] <- "CHISQUARE"
p4.sd <- ggplot(LG4.pos, aes(POSITION))+
  geom_line(data=subset(LG4.pos),aes(y=CHISQUARE),col="black", linetype="dotted")+
  geom_point(data=subset(LG4.pos),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 60))+
  geom_ribbon(data=subset(LG4.pos),aes(ymin=0,ymax=5.991),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG4.pos),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=20)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p4.sd


#################33
#HASTA AQUI
####################3

LG4.pos <- read.csv("LG4.sd.csv")
setdiff(LG4.pos[,1],LG4.sd[,4])
setdiff(LG4.pos[,2],LG4.sd[,1])

LG4.pos[,4] <- LG4.sd[,2][match(LG4.pos[,2],LG4.sd[,1])]
names(LG4.pos)[4] <- "CHISQUARE"
p4.sd <- ggplot(LG4.pos, aes(POSITION))+
  geom_line(data=subset(LG4.pos),aes(y=CHISQUARE),col="black", linetype="dotted")+
  geom_point(data=subset(LG4.pos),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 60))+
  geom_ribbon(data=subset(LG4.pos),aes(ymin=0,ymax=5.991),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG4.pos),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=20)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p4.sd

library(adehabitat)
wawotest(as.numeric(LG31$CHISQUARE > 5.991))
wawotest(as.numeric(LG17$CHISQUARE > 5.991))
wawotest(as.numeric(LG13$CHISQUARE > 5.991))

```

Now we are going to repeat the last analysis for LG17 and LG13 but excluding the loci that are not safely located

```{r}
LG17red <- read.csv(file = "LG17.red.csv")
LG17red$CIsup <- 5.991
LG17red$CIinf <- 0

p17red <- ggplot(LG17red, aes(POSITION))+
  geom_line(data=subset(LG17red),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG17red),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG17red),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG17red),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p17red

LG13red <- read.csv(file = "LG13.red.csv")
LG13red$CIsup <- 5.991
LG13red$CIinf <- 0

p13red <- ggplot(LG13red, aes(POSITION))+
  geom_line(data=subset(LG13red),aes(y=CHISQUARE),col="black",width=1,linetype="dotted")+
  geom_point(data=subset(LG13red),aes(y=CHISQUARE),col="black")+
  scale_y_continuous(limits = c(0, 15))+
  geom_ribbon(data=subset(LG13red),aes(ymin=CIinf,ymax=CIsup),alpha=0.5,fill="grey")+
  geom_errorbar(data=subset(LG13red),aes(ymin=CHISQUARE,ymax=CHISQUARE),width=1)+
  theme_bw(base_size=30)+
  xlab('Distance (CentiMorgan)') +
  ylab('SD (CHISQUARE)')
p13red


library(adehabitat)
wawotest(as.numeric(LG17red$CHISQUARE > 5.991))
wawotest(as.numeric(LG13$CHISQUARE > 5.991))

```



